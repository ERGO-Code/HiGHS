<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Feasibilty and optimality · HiGHS Documentation</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="HiGHS Documentation logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">HiGHS Documentation</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">About</a></li><li><a class="tocitem" href="../../installation/">Install HiGHS</a></li><li><a class="tocitem" href="../../executable/">Executable</a></li><li><span class="tocitem">Guide</span><ul><li><a class="tocitem" href="../">Introduction</a></li><li><a class="tocitem" href="../basic/">Basic features</a></li><li><a class="tocitem" href="../further/">Further features</a></li><li><a class="tocitem" href="../advanced/">Advanced features</a></li><li><a class="tocitem" href="../gpu/">GPU acceleration</a></li><li class="is-active"><a class="tocitem" href>Feasibilty and optimality</a></li></ul></li><li><span class="tocitem">Data structures</span><ul><li><a class="tocitem" href="../../structures/">Introduction</a></li><li><a class="tocitem" href="../../structures/enums/">Enums</a></li><li><input class="collapse-toggle" id="menuitem-5-3" type="checkbox"/><label class="tocitem" for="menuitem-5-3"><span class="docs-label">Classes</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../structures/classes/">Overview</a></li><li><a class="tocitem" href="../../structures/classes/HighsSparseMatrix/">HighsSparseMatrix</a></li><li><a class="tocitem" href="../../structures/classes/HighsLp/">HighsLp</a></li><li><a class="tocitem" href="../../structures/classes/HighsHessian/">HighsHessian</a></li><li><a class="tocitem" href="../../structures/classes/HighsModel/">HighsModel</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-4" type="checkbox"/><label class="tocitem" for="menuitem-5-4"><span class="docs-label">Structures</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../structures/structs/">Overview</a></li><li><a class="tocitem" href="../../structures/structs/HighsSolution/">HighsSolution</a></li><li><a class="tocitem" href="../../structures/structs/HighsBasis/">HighsBasis</a></li><li><a class="tocitem" href="../../structures/structs/HighsInfo/">HighsInfo</a></li><li><a class="tocitem" href="../../structures/structs/HighsLinearObjective/">HighsLinearObjective</a></li></ul></li></ul></li><li><a class="tocitem" href="../../callbacks/">Callbacks</a></li><li><span class="tocitem">Interfaces</span><ul><li><input class="collapse-toggle" id="menuitem-7-1" type="checkbox"/><label class="tocitem" for="menuitem-7-1"><span class="docs-label">C++</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../interfaces/cpp/">Getting started</a></li><li><a class="tocitem" href="../../interfaces/cpp/library/">The HiGHS library</a></li><li><a class="tocitem" href="../../interfaces/cpp/examples/">Examples</a></li></ul></li><li><a class="tocitem" href="../../interfaces/c_api/">C</a></li><li><a class="tocitem" href="../../interfaces/fortran/">Fortran</a></li><li><input class="collapse-toggle" id="menuitem-7-4" type="checkbox"/><label class="tocitem" for="menuitem-7-4"><span class="docs-label">Python</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../interfaces/python/">Getting started</a></li><li><a class="tocitem" href="../../interfaces/python/example-py/">Examples</a></li></ul></li><li><a class="tocitem" href="../../interfaces/csharp/">CSharp</a></li><li><a class="tocitem" href="../../interfaces/julia/">Julia</a></li><li><a class="tocitem" href="../../interfaces/other/">Other</a></li></ul></li><li><span class="tocitem">Options</span><ul><li><a class="tocitem" href="../../options/intro/">Introduction</a></li><li><a class="tocitem" href="../../options/definitions/">List of options</a></li></ul></li><li><a class="tocitem" href="../../parallel/">Parallel</a></li><li><a class="tocitem" href="../../solvers/">Solvers</a></li><li><a class="tocitem" href="../../terminology/">Terminology</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Guide</a></li><li class="is-active"><a href>Feasibilty and optimality</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Feasibilty and optimality</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/ERGO-Code/HiGHS/tree/latest/docs/src/guide/kkt.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="kkt"><a class="docs-heading-anchor" href="#kkt">Feasibilty and optimality</a><a id="kkt-1"></a><a class="docs-heading-anchor-permalink" href="#kkt" title="Permalink"></a></h1><p>Mathematically, continuous optimization problems have exact feasibilty and optimality conditions. However, since solvers cannot always satisfy these conditions exactly when using floating-point arithmetic, they do so to within tolerances. As explored below, some solvers aim to satisfy those tolerances absolutely, and others aim to satisfy tolerances relative to problem data. When tolerances are satisfied relatively, they are generally not satisfied absolutely. The use of tolerances relative to problem data is not consistent across solvers, and can give a misleading claim of optimality. To achieve consistency, HiGHS reassesses the optimal solution claimed by such a solver in a reasonable and uniform manner.</p><h3 id="Feasibilty-and-optimality-conditions"><a class="docs-heading-anchor" href="#Feasibilty-and-optimality-conditions">Feasibilty and optimality conditions</a><a id="Feasibilty-and-optimality-conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Feasibilty-and-optimality-conditions" title="Permalink"></a></h3><p>To discuss tolerances and their use in different solvers, consider the standard form linear programming (LP) problem with <span>$n$</span> variables and <span>$m$</span> equations (<span>$n\ge m$</span>).</p><p class="math-container">\[\begin{aligned}
\textrm{minimize}   \quad &amp; c^T\! x        \\
\textrm{subject to} \quad &amp; Ax = b  \\
                          &amp; x \ge 0,
\end{aligned}\]</p><p>The feasibilty and optimality conditions (KKT conditions) are that, at a point <span>$x$</span>, there exist (row) dual values <span>$y$</span> and reduced costs (column dual values) <span>$s$</span> such that</p><p class="math-container">\[\begin{aligned}
Ax=b&amp;\qquad\textrm{Primal~equations}\\
A^Ty+s=c&amp;\qquad\textrm{Dual~equations}\\
x\ge0&amp;\qquad\textrm{Primal~feasibility}\\
s\ge0&amp;\qquad\textrm{Dual~feasibility}\\
c^Tx-b^Ty=0&amp;\qquad\textrm{Optimality}
\end{aligned}\]</p><p>The optimality condition is equivalent to the complementarity condition that <span>$x^Ts=0$</span>. Since any LP problem can be transformed into standard form, the following discussion loses no generality. This discussion also largely applies to quadratic programming (QP) problems, with the differences explored below.</p><h3 id="The-HiGHS-feasibility-and-optimality-tolerances"><a class="docs-heading-anchor" href="#The-HiGHS-feasibility-and-optimality-tolerances">The HiGHS feasibility and optimality tolerances</a><a id="The-HiGHS-feasibility-and-optimality-tolerances-1"></a><a class="docs-heading-anchor-permalink" href="#The-HiGHS-feasibility-and-optimality-tolerances" title="Permalink"></a></h3><p>HiGHS has separate tolerances for the following, listed with convenient mathematical notation</p><ul><li><a href="../../options/definitions/#option-primal-feasibility-tolerance">Primal feasibility</a> (<span>$\epsilon_P$</span>)</li><li><a href="../../options/definitions/#option-dual-feasibility-tolerance">Dual feasibility</a> (<span>$\epsilon_D$</span>)</li><li>Residual errors in the <a href="../../options/definitions/#option-primal-residual-tolerance">primal equations</a> (<span>$\epsilon_R$</span>)</li><li>Residual errors in the <a href="../../options/definitions/#option-dual-residual-tolerance">dual equations</a> (<span>$\epsilon_C$</span>)</li><li><a href="../../options/definitions/#option-optimality-tolerance">Optimality</a> (<span>$\epsilon_{O}$</span>)</li></ul><p>All are set to the same default value of <span>$10^{-7}$</span>. Although each can be set to different values by the user, if the user wishes to solve LPs to a general lower or higher tolerance, the value of the <a href="../../options/definitions/#option-kkt-tolerance">KKT tolerance</a> can be changed from this default value.</p><h3 id="When-HiGHS-yields-an-optimal-solution"><a class="docs-heading-anchor" href="#When-HiGHS-yields-an-optimal-solution">When HiGHS yields an optimal solution</a><a id="When-HiGHS-yields-an-optimal-solution-1"></a><a class="docs-heading-anchor-permalink" href="#When-HiGHS-yields-an-optimal-solution" title="Permalink"></a></h3><p>When HiGHS returns a model status of optimal, the solution will satisfy feasibility and optimality tolerances absolutely or relatively according to whether the solver yields a basic solution.</p><h3 id="Solutions-with-a-corresponding-basis"><a class="docs-heading-anchor" href="#Solutions-with-a-corresponding-basis">Solutions with a corresponding basis</a><a id="Solutions-with-a-corresponding-basis-1"></a><a class="docs-heading-anchor-permalink" href="#Solutions-with-a-corresponding-basis" title="Permalink"></a></h3><p>The HiGHS simplex solvers and the interior point solver after crossover yield an optimal basic solution of the LP, consisting of <span>$m$</span> basic variables and <span>$n-m$</span> nonbasic variables. At any basis, the nonbasic variables are zero, and values for the basic variables are given by solving a linear system of equations. Values for the row dual values (<span>$y$</span>) can be computed by solving a linear system of equations, and the column dual values are then given by <span>$s=c-A^Ty$</span>. With exact arithmetic, the basic dual values are zero by construction.</p><p>When primal and dual values are computed using floating-point arithmetic, the basic dual values are set to zero so the optimality condition holds by construction. However, the primal and dual equations may not be satisfied exactly, so have nonzero residuals. Fortunately, when solving a linear system of equations using a stable technique, any residuals are small relative to the RHS of the equations, whatever the condition of the matrix of coefficients. Hence HiGHS does not assess the primal residuals, or the dual residuals for basic variables. Thus optimality for a basic solution is assessed by HiGHS according to whether the following conditions hold</p><p class="math-container">\[\begin{aligned}
x_i\ge-\epsilon_P&amp;\qquad\forall i=1,\ldots,n\\
s_i\ge-\epsilon_D&amp;\qquad\forall i=1,\ldots,n.
\end{aligned}\]</p><p>The HiGHS active set QP solver has an objective function <span>$(1/2)x^TQx + c^Tx$</span>, and maintains the QP equivalent of a basis in which a subset of (up to <span>$n$</span>) variables are zero. However, there are variables that are off their bounds whose reduced costs are not zero by construction. At an optimal solution they will only be less than a dual feasibility tolerance in magnitude, so the optimality condition will not be satisfied by construction. The primal and dual equations (where the latter is <span>$A^Ty+s=Qx+c$</span>) will be satisfied with small residuals. Optimality is assessed by HiGHS according to whether primal and dual feasibility is satisfied to within the corresponding tolerance.</p><h3 id="Solutions-without-a-corresponding-basis"><a class="docs-heading-anchor" href="#Solutions-without-a-corresponding-basis">Solutions without a corresponding basis</a><a id="Solutions-without-a-corresponding-basis-1"></a><a class="docs-heading-anchor-permalink" href="#Solutions-without-a-corresponding-basis" title="Permalink"></a></h3><p>The HiGHS PDLP solver and the interior point solver without crossover (IPX) yield &quot;optimal&quot; primal and dual values that satisfy internal conditions for termination of the underlying algorithm. These conditions are discussed below, and are used for good reason. However they can lead to a misleading claim of optimality.</p><h4 id="Interior-point-solutions"><a class="docs-heading-anchor" href="#Interior-point-solutions">Interior point solutions</a><a id="Interior-point-solutions-1"></a><a class="docs-heading-anchor-permalink" href="#Interior-point-solutions" title="Permalink"></a></h4><p>The interior point algorithm uses a single feasibility tolerance <span>$\epsilon=\min(\epsilon_P, \epsilon_D)$</span>, and an independent <a href="../../options/definitions/#option-ipm-optimality-tolerance">optimality tolerance</a> (<span>$\epsilon_{IPM}$</span>) that, by default, is (currently) ten times smaller than the other feasibility and optimality tolerances used by HiGHS. It terminates when</p><p class="math-container">\[\begin{aligned}
\|Ax-b\|_\infty&amp;\le(1+\|b\|_\infty)\epsilon_R\\
\|c-A^Ty+s\|_\infty&amp;\le(1+\|c\|_\infty)\epsilon_C\\
-x_i&amp;\le\epsilon\qquad\forall i=1,\ldots,n\\
-s_i&amp;\le		      \epsilon\qquad\forall i=1,\ldots,n\\
|c^Tx-b^Ty|&amp;\le(1+|c^Tx+b^Ty|/2)\epsilon_{IPM}.
\end{aligned}\]</p><h4 id="PDLP-solutions"><a class="docs-heading-anchor" href="#PDLP-solutions">PDLP solutions</a><a id="PDLP-solutions-1"></a><a class="docs-heading-anchor-permalink" href="#PDLP-solutions" title="Permalink"></a></h4><p>The PDLP algorithm uses an independent <a href="../../options/definitions/#option-pdlp-optimality-tolerance">optimality tolerance</a> (<span>$\epsilon_{PDLP}$</span>) that is equal to the other feasibility and optimality tolerances used by HiGHS. It determines values of <span>$x\ge0$</span> and <span>$y$</span>, and chooses <span>$s$</span> to be the non-negative values of <span>$c-A^Ty$</span>. Hence it guarantees primal and dual feasibility by construction. It terminates when</p><p class="math-container">\[\begin{aligned}
\|Ax-b\|_2&amp;\le (1+\|b\|_2)\epsilon_P\\
\|c-A^Ty-s\|_2&amp;\le (1+\|c\|_2)\epsilon_D\\
|c^Tx-b^Ty|&amp;\le (1+|c^Tx|+|b^Ty|)\epsilon_{PDLP}.
\end{aligned}\]</p><h4 id="HiGHS-solutions"><a class="docs-heading-anchor" href="#HiGHS-solutions">HiGHS solutions</a><a id="HiGHS-solutions-1"></a><a class="docs-heading-anchor-permalink" href="#HiGHS-solutions" title="Permalink"></a></h4><p>The relative measures used by PDLP and IPX assume that all components of the cost and RHS vectors are relevant. When an LP problem is in standard form this is true for <span>$b$</span>, but not necessarily for the cost vector <span>$c$</span>. Consider a large component of <span>$c$</span> for which the corresponding reduced cost value in <span>$s$</span> is also large, in which case the LP solution is insensitive to the cost. This component will contribute significantly to <span>$\|c\|$</span> and, hence, the RHS of the dual residual condition, allowing large values of <span>$\|c-A^Ty-s\|$</span> to be accepted. However, this can lead to unacceptably large absolute residual errors and non-optimal solutions being deemed &quot;optimal&quot;. When equations in <span>$Ax=b$</span> correspond to inequality constraints with large RHS values and a slack variable (so the constraint is redundant) the same issue occurs in the case of primal residual errors. The solution of the LP is not sensitive to this large RHS value, but its contribution to <span>$||b||$</span> can allow large absolute primal residual errors to be overlooked.</p><p>To make an informed assessment of whether an &quot;optimal&quot; solution obtained by IPX or PDLP is acceptable, HiGHS computes infinity norm measures of <span>$b$</span> and <span>$c$</span> corresponding to the components that define the optimal solution. For <span>$c$</span> these are the components corresponding to positive values of <span>$x$</span> and reduced costs that are close to zero. For <span>$b$</span>, these are the components corresponding to constraints that are (close to being) satisfied exactly. The resulting measures are smaller than <span>$\|b\|$</span> or <span>$\|c\|$</span>, and may lead to relative measures of primal/dual residual errors or infeasibilities not being satisfied, so the status of the solver&#39;s &quot;optimal&quot; solution may be reduced to &quot;unknown&quot;. When this happens - and possibly if tolerances on relative measures <em>have</em> been satisfied - users can consult the absolute and relative measures available via <a href="../../structures/structs/HighsInfo/#info-num-primal-infeasibilities">HighsInfo</a>.</p><h3 id="Discrete-optimization-problems"><a class="docs-heading-anchor" href="#Discrete-optimization-problems">Discrete optimization problems</a><a id="Discrete-optimization-problems-1"></a><a class="docs-heading-anchor-permalink" href="#Discrete-optimization-problems" title="Permalink"></a></h3><p>Discrete optimization problems, such as the mixed-integer programming (MIP) problems solved by HiGHS, have no local optimality conditions. Variables required to take integer values will do so to within the <code>mip_feasibility_tolerance</code>. Since MIP sub-problems are solved with the simplex solver, the values of the variables and constraints will satisfy absolute feasibility tolerances. Within the MIP solver, the value of <code>mip_feasibility_tolerance</code> is used for <code>primal_feasibility_tolerance</code> when solving LP sub-problems, and one tenth of this value is used for <code>dual_feasibility_tolerance</code>. Hence any value of <code>primal_feasibility_tolerance</code> (or <code>dual_feasibility_tolerance</code>) set by the user has no effect of the MIP solver.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../gpu/">« GPU acceleration</a><a class="docs-footer-nextpage" href="../../structures/">Introduction »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Saturday 7 June 2025 10:26">Saturday 7 June 2025</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
